[settings]
experimental = true
lockfile = true

############################################################################
# Tools Configuration                                                      #
############################################################################

[tools]

# ==========================================================================
# Compilers
# ==========================================================================

# Rust toolchain version (using latest stable)
rust = "latest"

# ==========================================================================
# Other Tools
# ==========================================================================
# Node.js for jscpd & eslint
#
[tools.node]
version = "latest"

# Python and package manager
#
[tools.python]
version = "3.11" # Will install 3.11 or above based on availability
[tools.uv]
version = "latest"

# Cargo tools (install via cargo)
# Note: cargo-tarpaulin requires system dependencies to be installed first:
#   Ubuntu/Debian: sudo apt install pkg-config libssl-dev
#   Fedora/RHEL:   sudo dnf install pkg-config openssl-devel
#   macOS:         brew install pkg-config openssl
#
# After installing system dependencies, run:
#   cargo install cargo-tarpaulin
#
# Uncomment to install via mise (requires system deps first):
"cargo:cargo-tarpaulin" = "latest"
"cargo:cargo-audit" = "latest"
"cargo:cargo-deny" = "latest"

# Other useful tools:
# "cargo:cargo-watch" = "latest"
# "cargo:cargo-outdated" = "latest"
# "cargo:cargo-bloat" = "latest"

# https://github.com/koalaman/shellcheck/releases
# e.g. https://github.com/koalaman/shellcheck/releases/download/v0.11.0/shellcheck-v0.11.0.darwin.x86_64.tar.xz
#
[tools."github:koalaman/shellcheck"]
version = "0.11.0"

[tools."github:koalaman/shellcheck".platforms]
linux-x64 = { asset_pattern = "shellcheck-*.linux.x86_64.tar.xz" }
macos-arm64 = { asset_pattern = "shellcheck-*.darwin.aarch64.tar.xz" }
windows-x64 = { asset_pattern = "shellcheck-*.zip" }

# https://github.com/PowerShell/PowerShell/releases
# e.g. https://github.com/PowerShell/PowerShell/releases/download/v7.5.4/powershell-7.5.4-osx-arm64.tar.gz
#
[tools."github:PowerShell/PowerShell"]
version = "latest"

[tools."github:PowerShell/PowerShell".platforms]
linux-x64 = { asset_pattern = "powershell-*-linux-x64.tar.gz" }
macos-arm64 = { asset_pattern = "powershell-*-osx-arm64.tar.gz" }
windows-x64 = { asset_pattern = "PowerShell-*-win-x64.zip" }

############################################################################
# Hooks                                                    #
############################################################################

# Note: rust-analyzer is installed as a rustup component, not via mise:
#   rustup component add rust-analyzer
# or via the hook below (uncomment to enable).
[hooks]
postinstall = "{% if os() != 'windows' %}chmod -R 755 $(mise bin-paths github:PowerShell/PowerShell)/pwsh 2>/dev/null || true{% endif %}"

#   enter = "rustup component add rust-analyzer 2>/dev/null || true"
